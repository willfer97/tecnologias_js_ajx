<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AJAX</title>

</head>
<body background="https://media.istockphoto.com/photos/beige-abstract-backgroundlight-centerspotwhiteemptylight-picture-id1146974104?k=20&m=1146974104&s=612x612&w=0&h=sewjma0yJbluWRhNQTj_kRIuj9i9KY6TvigGrf2t7qM=">

        <div style="text-align: center; font-size: 60px; border: 1px solid red;">

            AJAX
            
            </div>
        <div style="text-align: center; font-size: 60px; border: 1px solid blue;">

            <nav>
                <a href="https://willfer97.github.io/tecnologias_js_ajx/javascript.html">ANTERIOR</a> | 
                <a href="https://willfer97.github.io/tecnologias_js_ajx/index.html">INICIO</a> |
            </nav>
            
        </div>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Unofficial_JavaScript_logo_2.svg/245px-Unofficial_JavaScript_logo_2.svg.png"/>
        <script type="text/javascript">
            String.prototype.transformaCaracteresEspeciales = function() {
              return unescape(escape(this).
                                replace(/%0A/g, '<br/>').
                                replace(/%3C/g, '&lt;').
                                replace(/%3E/g, '&gt;'));
            }
           
            var estadosPosibles = ['No inicializado', 'Cargando', 'Cargado', 'Interactivo', 'Completado'];
            var tiempoInicial = 0;
           
            window.onload = function() {
              // Cargar en el input text la URL de la página
              var recurso = document.getElementById('recurso');
              recurso.value = location.href;
           
              // Cargar el recurso solicitado cuando se pulse el botón MOSTRAR CONTENIDOS
              document.getElementById('enviar').onclick = cargaContenido;
            }
           
            function cargaContenido() {
              // Borrar datos anteriores
              document.getElementById('contenidos').innerHTML = "";
              document.getElementById('estados').innerHTML = "";
           
              // Instanciar objeto XMLHttpRequest
              if(window.XMLHttpRequest) {
                peticion = new XMLHttpRequest();
              }
              else {
                peticion = new ActiveXObject("Microsoft.XMLHTTP");
              }
           
              // Preparar función de respuesta
              peticion.onreadystatechange = muestraContenido;
           
              // Realizar petición
              tiempoInicial = new Date();
              var recurso = document.getElementById('recurso').value;
              peticion.open('GET', recurso+'?nocache='+Math.random(), true);
              peticion.send(null);
            }
           
            // Función de respuesta
            function muestraContenido() {
              var tiempoFinal = new Date();
              var milisegundos = tiempoFinal - tiempoInicial;
           
              var estados = document.getElementById('estados');
              estados.innerHTML += "[" + milisegundos + " mseg.] " + estadosPosibles[peticion.readyState] + "<br/>";
           
              if(peticion.readyState == 4) {
                if(peticion.status == 200) {
                  var contenidos = document.getElementById('contenidos');
                  contenidos.innerHTML = peticion.responseText.transformaCaracteresEspeciales();
                }
                muestraCabeceras();
                muestraCodigoEstado();
              }
            }
           
            function muestraCabeceras() {
              var cabeceras = document.getElementById('cabeceras');
              cabeceras.innerHTML = peticion.getAllResponseHeaders().transformaCaracteresEspeciales();
            }
           
            function muestraCodigoEstado() {
              var codigo = document.getElementById('codigo');
              codigo.innerHTML = peticion.status + "<br/>" + peticion.statusText;        
            }
          </script>
          </head>
          <body>
          <form action="#">
            URL: <input type="text" id="recurso" size="70" />
            <input type="button" id="enviar" value="Mostrar contenidos" />
          </form>
           
          <div id="principal">
            <h2>Contenidos del archivo:</h2>
            <div id="contenidos"></div>
           
            <h2>Cabeceras HTTP de la respuesta del servidor:</h2>
            <div id="cabeceras"></div>
          </div>
           
          <div id="secundario">
            <h2>Estados de la petición:</h2>
            <div id="estados"></div>
           
            <h2>Código de estado:</h2>
            <div id="codigo"></div>
          </div>
        
</body>
</html>